## Детальная документация по файлам

### 1. Главный скрипт: `src/scripts/main.sh`

#### Назначение
Оркестрирует весь процесс выполнения: загрузка конфигурации, обработка параметров, валидация, вычисления и вывод результатов.

#### Ключевые функции

**Инициализация и конфигурация:**
```bash
# Определение корневых путей
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/../.." && pwd)"

# Загрузка конфигурации из app.env
if [[ -f "$PROJECT_ROOT/config/app.env" ]]; then
  set -a
  . "$PROJECT_ROOT/config/app.env"
  set +a
fi
```

**Обработка аргументов командной строки:**
- `--group=` - номер группы студентов
- `--subject=` - название предмета
- `--test=` - название теста
- `--action=` - действие (both/max-correct/max-wrong)

**Основной поток выполнения:**
1. Загрузка зависимостей (`io.sh`, `paths.sh`, `stats.sh`)
2. Получение параметров (CLI или интерактивно)
3. Валидация существования файла теста
4. Проверка наличия группы в тесте
5. Вычисление статистики
6. Форматированный вывод результатов

### 2. Модуль ввода-вывода: `src/scripts/lib/io.sh`

#### Функции интерактивного ввода

**`ask_group()`**
- Запрашивает номер группы у пользователя
- Вывод в stderr, результат в stdout

**`ask_subject()`**
- Предлагает выбор из двух предметов:
  - 1) Цирковое_Дело
  - 2) Поп-Культуроведение
- Возвращает соответствующее название

**`ask_test(subject)`**
- Получает список доступных тестов для предмета
- Отображает список и запрашивает выбор теста

### 3. Модуль работы с путями: `src/scripts/lib/paths.sh`

#### Инициализация структуры данных

**Определение LAB_ROOT:**
```bash
# Приоритет 1: labfiles-25 структура
if [[ -d "$DATA_ROOT/labfiles-25/Цирковое_Дело" ]] || [[ -d "$DATA_ROOT/labfiles-25/Поп-Культуроведение" ]]; then
  LAB_ROOT="$DATA_ROOT/labfiles-25"
# Приоритет 2: прямая структура
elif [[ -d "$DATA_ROOT/Цирковое_Дело" ]] || [[ -d "$DATA_ROOT/Поп-Культуроведение" ]]; then
  LAB_ROOT="$DATA_ROOT"
```

#### Основные функции

**`get_tests_file(subject, test_name)`**
- Возвращает полный путь к файлу теста
- Формат: `{LAB_ROOT}/{subject}/tests/{test_name}`

**`list_tests(subject)`**
- Возвращает список доступных тестов для предмета
- Использует `ls -1` для получения списка файлов

**`get_total_questions(subject)`**
- Возвращает общее количество вопросов в тесте:
  - Цирковое_Дело: 25 вопросов
  - Поп-Культуроведение: 5 вопросов

### 4. Модуль статистики: `src/scripts/lib/stats.sh`

#### Функции анализа данных

**`group_exists(file, group)`**
- Проверяет наличие группы в файле теста
- Использует awk для точного сравнения первого поля
- Возвращает код выхода: 0 - найдена, 1 - не найдена

**`list_groups(file)`**
- Извлекает уникальные группы из файла теста
- Использует `cut` и `sort -u`

**`find_max_for_group(file, group, total)`**
- Основная функция вычисления статистики

#### Алгоритм вычисления максимумов:

```bash
while IFS= read -r line; do
  # Парсинг полей строки
  g=$(echo "$line" | cut -d';' -f1
```