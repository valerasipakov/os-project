# TEST_REPORT.md — Мини-отчёт по ручному тестированию

**Дата:** 2025-11-04  
**Статус:** ✅ Успешно (все сценарии пройдены)

---

## 1) Краткое резюме
- **Объект тестирования:** `src/scripts/main.sh` и библиотечные скрипты (`lib/io.sh`, `lib/paths.sh`, `lib/stats.sh`).
- **Цель:** проверить режимы `max-correct`, `max-wrong`, `both`; обработку флагов `--group/--subject/--test`; интерактив; приоритет `DATA_ROOT`; разделение stdout/stderr; ошибки «файл теста/группа/предмет».
- **Итог:** поведение соответствует документации и ожидаемым результатам.

## 2) Среда
- ОС/шелл: Unix-подобная (Linux/macOS), bash ≥ 4.
- Права исполнения на скрипты выданы (`chmod +x src/scripts/main.sh src/scripts/lib/*.sh`).
- Конфигурация `DATA_ROOT`:
  - Проверены обе поддерживаемые структуры (`/data` и `/data/labfiles-25`).
  - Приоритет ENV над `config/app.env` подтверждён.
  - Относительные пути нормализуются в абсолютные.
- Данные/ветка/коммит: *по проекту*.

## 3) Результаты сценариев

| ID  | Сценарий | Команда/действия (пример) | Ожидаемое поведение | Итог |
|----:|---|---|---|---|
| A1 | Все флаги, `--action=both` | `DATA_ROOT=... ./src/scripts/main.sh --group=Ae-21-22 --subject="Цирковое_Дело" --test=TEST-1 --action=both` | Печать обоих максимумов (прав./неправ.) | **Pass** |
| A2 | Только `max-correct` | `--action=max-correct` | Печать только блока «максимум правильных» | **Pass** |
| A3 | Только `max-wrong` | `--action=max-wrong` | Печать только блока «максимум неправильных» | **Pass** |
| A4 | Структура `/data/labfiles-25` | `DATA_ROOT=/…/data/labfiles-25 ...` | Результаты совпадают с A1 | **Pass** |
| A5 | Нормализация абсолютного пути | `DATA_ROOT=./data ...` | Скрипт переводит в абсолютный путь | **Pass** |
| A6 | Интерактив без флагов | запуск без флагов | Подсказки/меню → **stderr**, значения → **stdout** | **Pass** |
| A7 | Обрезка пробелов в `--group` | `--group="  Ae-21-22  "` | Группа распознана как `Ae-21-22` | **Pass** (исправлено в коммите `4f458a38c1ef6ec78015e227a755b67bc44e497a`) |
| A8 | Оба предмета | subject=`Цирковое_Дело` (25 вопросов) и `Поп-Культуроведение` (5) | Оба предмета корректны | **Pass** |
| B9 | Приоритет ENV | env ≠ `config/app.env` | Берётся значение из ENV | **Pass** |
| C10 | Тест не найден | `--test=TEST-999` | Ошибка, код выхода `1` | **Pass** |
| C11 | Группа не найдена | `--group=Zz-00-00` | Ошибка со списком групп, код `1` | **Pass** |
| C12 | Неверный `--subject` | `--subject="Математика"` | Ошибка валидации | **Pass** |
| C13 | Разделение потоков | `>stdout.log 2>stderr.log` | Подсказки—stderr, значения—stdout | **Pass** |

## 4) Найденные проблемы
| ID | Заголовок | Статус | Шаги воспроизведения | Ожидание | Факт | Коммит/фикс | Severity |
|---:|---|---|---|---|---|---|---|
| BUG-1 | Обрезка пробелов в `--group` не применялась | **Resolved** | Запуск с `--group="  Ae-21-22  "` | Значение `Ae-21-22` без пробелов | Скрипт воспринимал пробелы как часть значения | Исправлено в `4f458a38c1ef6ec78015e227a755b67bc44e497a` | Minor |

## 5) Рекомендации
- Поведение и документация согласованы. Дополнительно можно:
  - Добавить флаг `--version`/`--help` в вывод `stdout` при явном запросе, оставив интерактивные подсказки в `stderr`.
  - Локально поддерживать `pytest`/Docker-прогон как pre-commit hook.

## 6) Автотесты
- **Набор:** unit-тесты из `src/tests/unit_tests` (локальный прогон через `pytest`; возможен также Docker-прогон).
- **Покрытие:** базовые позитивные сценарии (валидные `--group/--subject/--test`, режимы `both`, `max-correct`, `max-wrong`, корректная работа `DATA_ROOT`).
- **Результат:** ✅ Все автотесты пройдены.
- **Как запускать локально:**
  ```bash
  pip install -q pytest
  pytest -q src/tests/unit_tests
  ```
- **Как запускать в Docker:**
  ```bash
  docker build -t os-project-tests .
  docker run --rm os-project-tests
  ```
