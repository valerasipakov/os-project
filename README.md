
# os-project
##  Структура проекта
```
os-project/
├── data/                        # Данные и материалы для лабораторных работ
│   ├── labfiles-25/             # Распакованные файлы лабораторной работы 
│   └── labfiles-3-25.zip        # Архив с файлами лабораторной работы
│
├── documentation.md             # Подробная документация и отчёт по проекту
├── README.md                    # Краткое описание проекта и инструкция по запуску
├── requirements.txt             # Список зависимостей Python
│
└─ src/                          # Исходный код проекта
│  ├── script/                   # Основные скрипты и модули программы
│  └── tests/                    # Тесты для проверки работы кода
```

## Команда работавшая над проектом
Сипаков В.А. Аэ-21-22 менеджер  
Марцевой Я.А. Аэ-21-22 тестировщик
Збуривский К.А. Аэ-21-22 разработчик


# Проект: Анализ результатов тестов (Bash)

Набор bash‑скриптов для анализа результатов тестов по заданным **группе**, **предмету** и **тесту**.  
Скрипт выводит:
- имя(имена) студента(ов) с **максимальным числом правильных** ответов и значение;
- имя(имена) студента(ов) с **максимальным числом неправильных** ответов и значение.

> Количество вопросов по предметам:
> - `Цирковое_Дело` — 25
> - `Поп-Культуроведение` — 5

---

## Структура

```
.
├── config/
│   └── app.env                   # централизованная настройка DATA_ROOT
├── data/                         # реальные данные (в проде)
│   └── labfiles-25/              # или без подкаталога — поддерживается
├── src/
│   └── scripts/
│       ├── main.sh               # точка входа
│       └── lib/
│           ├── io.sh             # интерактивный ввод (stdout только значения)
│           ├── paths.sh          # работа с DATA_ROOT, резолв путей
│           ├── stats.sh          # валидация группы, расчёт максимумов
└── src/tests/
    └── unit_tests/               # pytest‑тесты
        ├── conftest.py
        ├── test_happy_path.py
        └── test_group_validation.py
```

---

## Требования

- bash ≥ 4
- Unix‑подобная ОС (Linux/macOS)
- Для тестов: Python 3.11+ и `pytest` (или Docker)

---

## Установка прав

```bash
chmod +x src/scripts/main.sh src/scripts/lib/*.sh
```

---

## Конфигурация `DATA_ROOT`

`DATA_ROOT` задаёт корень данных. Поддерживаются два варианта структуры:

- `DATA_ROOT=/path/to/data/labfiles-25`
- `DATA_ROOT=/path/to/data` (будет автоматически использован подкаталог `labfiles-25`, если он есть)

Способы задать:

1) Через `config/app.env`:
```bash
DATA_ROOT="${PROJECT_ROOT}/data"             # или ${PROJECT_ROOT}/data/labfiles-25
```

2) Переменной окружения при запуске:
```bash
DATA_ROOT="$(pwd)/data" src/scripts/main.sh ...
```

3) Абсолютный путь предпочтительнее. `main.sh` нормализует `DATA_ROOT` в абсолютный, если задан.

Приоритет: **переменная окружения > config/app.env**.

---

## Запуск

Аргументы:
```
./src/scripts/main.sh [--group=<строка>] [--subject=<строка>] [--test=<имя>] [--action=<режим>]
```

Флаги:

| Флаг | Пример | Обязательно | Назначение |
|---|---|:---:|---|
| `--group` | `--group=Ae-21-22` | нет | Номер группы. Если не задан — будет запрошен. |
| `--subject` | `--subject="Цирковое_Дело"` | нет | Предмет: `Цирковое_Дело` или `Поп-Культуроведение`. |
| `--test` | `--test=TEST-1` | нет | Имя файла теста (`TEST-1` … `TEST-4`). |
| `--action` | `--action=both` | нет | `max-correct`, `max-wrong`, `both` (по умолчанию). |

Если запустить без флагов — скрипт задаст вопросы интерактивно. Все подсказки/меню печатаются в **stderr**, в **stdout** возвращаются только выбранные значения.

---

## Примеры

Все показатели:
```bash
./src/scripts/main.sh --group=Ae-21-22 --subject="Цирковое_Дело" --test=TEST-1 --action=both
```

Только максимум правильных:
```bash
./src/scripts/main.sh --group=Ae-21-22 --subject="Поп-Культуроведение" --test=TEST-2 --action=max-correct
```

Только максимум неправильных:
```bash
./src/scripts/main.sh --group=Ae-21-22 --subject="Цирковое_Дело" --test=TEST-3 --action=max-wrong
```

---

## Валидации и ошибки

- Проверка наличия файла теста. При отсутствии — завершение с кодом `1`.
- Проверка существования группы в выбранном тесте:
  - При отсутствии — завершение с кодом `1` и список доступных групп.
- Нормализация ввода группы (обрезка пробелов).
- `paths.sh` целиком опирается на `DATA_ROOT` и больше ничего не «угадывает».

---

## Тесты (pytest)

Локально:
```bash
pip install -q pytest
pytest -q src/tests/unit_tests && echo "TESTS PASSED" || (echo "TESTS FAILED"; exit 1)
```

Через Docker:
```bash
docker build -t os-project-tests .
docker run --rm os-project-tests
```

---

## Пример вывода

```
Группа: Ae-21-22
Предмет: Цирковое_Дело
Тест: TEST-1
Студент(ы) с максимальным числом правильных (20): CircusMan
Студент(ы) с максимальным числом неправильных (18): ClownGuy
```

Если у нескольких студентов значение совпадает, выводятся все.

---

## Траблшутинг

- «Файл теста не найден»: проверьте `DATA_ROOT`, `--subject`, `--test`.
- «Группа не найдена»: проверьте `--group` и список доступных групп, напечатанный скриптом.
- В pytest используйте фикстуру окружения или проставляйте `DATA_ROOT` в `env` процесса.

